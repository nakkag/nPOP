nPOP Ver 1.2.5
--
■ はじめに
このソフトはメールサーバ(POP3)上のメールを表示します。
一般的なメーラのリモートメール、仮想メールの機能をソフトにした感じになっています。

メール一覧で表示されるメールは現在サーバ上にあるメールのみです。したがって一覧
にメールが表示されていてもサーバからメールが削除されると一覧から消えます。

外出先などで読む必要が無いメールを受信したり、必要の無いメールを管理するのでは
なく、ヘッダのみを持ってきて一覧を作成して必要なメールだけを受信することができ
ます。

他の使い方として、メールの着信チェックとしてや、サーバ上のメールの管理などにも
使えます。フロッピーディスク１枚に入れて全ての処理を行えるためマシンが色々変わ
る場合にも便利です。

機能
    ・メール受信 (POP3, APOP)
    ・メール送信 (SMTP, SMTP認証, POP before SMTP)
    ・マルチアカウント (巡回受信可能)
    ・自動チェック
    ・保存箱にメールを保存
    ・メール一覧のスレッド表示
    ・添付ファイルの送受信 (RFC 2231)
    ・受信フィルタ
    ・簡易アドレス帳
    ・TLS/SSL/STARTTLS通信

■ 動作環境
	Windows XP, Vista, 7, 8, 8.1, 10, 11

	nPOP for iPhone
	    https://apps.apple.com/jp/app/npop-for-iphone/id368477936

インストールは適当なフォルダにコピーして実行するだけです。
設定は nPOP.exe と同じ場所に nPOP.ini を作成して書きみます。

アンインストールは以下のファイルを削除するだけです。
	nPOP.exe
	nPOP.ini
	Address.lst
	SaveBox.dat
	SendBox.dat
	MailBox-n.dat (n は番号)

nPOPは、インターネットに接続できる環境での利用が前提です。

■ 使い方
基本的な動作は、以下の流れです。(「新着取得時の行数」が 0 の場合)
	1. アカウントの設定
	2. 「新着チェック」でサーバ内のメール一覧を取得
	3. 本文を読みたいメールに「受信用マーク」を付加
	4. 「マークを実行」にて受信マークの付いたメールを受信
	5. 「開く」で本文を読む

「新着取得時の行数」を100に設定してあると「新着チェック」で100行文の本文を取得
するため、そのメールを「開く」で本文を読むことが出来ます。
完全にメールを受信するには更に「受信用マーク」を付けて「マークを実行」を選択す
ると本文を完全に受信できます。

「新着取得位置の初期化」を行うと一覧から削除したメールでサーバに残っているメー
ルを再取得することができます。

最後に取得したメールのアイコンには [!] マークが付加されています。次の新着チェッ
クで新しいメールが存在している場合に前回の [!] が解除されます。

サーバにメールが無くなった時点で一覧から消えてしまうので保存しておきたいメール
は保存箱コピーしてください。保存箱にコピーしたメールは終了時にファイルに保存さ
れます。

受信したメールの内容を表示したときに、URLをダブルクリックするとそのURLを開きま
す。
http:// と https:// と ftp:// の場合はブラウザを起動します。mailto: の場合は
nPOPのメールを送信する画面を表示してメールを編集することができます。

■ アカウント
アカウントは複数作成することができ巡回してチェックを行うことができます。
メニューのアカウントの追加で新しくアカウントを作成することができ、メニューのア
カウントの設定にてアカウント毎の設定の変更を行うことができます。作成できるアカ
ウントの数に制限はありません。いくつで作成可能です。

アカウントのメニューから「追加」を選択すると新規にアカウントを追加することがで
きます。「設定」を選択するとアカウントの設定を行うことができます。

「受信」のタブは受信(POP3)の設定を行います。
	・アカウントの名前 - アカウントを識別するための名前(タイトル)
	・POP3サーバ       - POP3(受信用)のサーバ名
	・ポート番号       - POP3サーバのポート番号 (通常 110)
	・ユーザ名         - POP3サーバにログインするためのユーザ名
	・パスワード       - POP3サーバにログインするためのパスワード

	「APOP を使って認証」にチェックを入れるとPOP3サーバにログインするとき
	にパスワードを暗号化して認証を行います。POP3サーバがAPOPに対応している
	必要があります。

	「SSL を使用する」にチェックを入れると暗号化して通信します。

	「巡回チェック対象外」にチェックを入れると巡回チェック時にこのアカウン
	トはチェックしないようになります。

	「'RETR' を使わない」にチェックを入れると本文を全て受信するコマンドで
	RETRコマンドを使わずにTOPコマンドで受信します。
	本文を全て受信するとメールが削除される設定になっているサーバの場合に
	この設定を使用してください。サーバがTOPコマンドをサポートしていない
	場合はエラーになります。

	パスワードを省略した場合はサーバに接続するときに入力を求められます。

「送信」のタブは送信(SMTP)の設定を行います。
	・名前             - 送信者の名前
	・メールアドレス   - 送信者のメールアドレス
	・SMTPサーバ       - SMTP(送信用)のサーバ名
	・ポート番号       - SMTPサーバのポート番号 (通常 25)

	「SMTP認証」にチェックを入れるとSMTPサーバに接続するときに[設定]で指定
	したユーザ名とパスワードで認証を行います。SMTPサーバがSMTP認証に対応し
	ている必要があります。

	「SSL を使用する」にチェックを入れると暗号化して通信します。

	「POP before SMTP」は送信する前に受信を行って認証を行う必要がある場合
	にチェックを入れてください。

	「送信時に自分宛てにコピーを送信する」にチェックを入れるとメール送信時
	にそのアカウントのメールアドレスを Bcc: に加えて送信します。

「作成」のタブは送信メールの作成時にメールの最後に付加する署名(シグネチャ)の設
定を行います。

「フィルタ」のタブは新着メールを受信するときに特定のメールを受信しないや特定の
メールのみを受信するなどの設定を行います。

アカウント間の移動は一覧画面上部のコンボボックスにて行います。一覧表示画面でア
カウント間の移動は Alt+↑↓でも行うことができます。

オプションの受信で全アカウントのメールの保存方法を設定できます。
	・ヘッダと本文を保存
		前回終了したときと同じ状態になります。

	・ヘッダのみを保存
		一覧は前回終了したときの状態ですが本文は無くなります。

	・保存しない
		一覧は空になります。
		しかし前回最後に受信したメールの情報を保持しているのでチェック
		を行うと前回最後に受信した次のメールより受信を行います。
		「新着取得位置の初期化」を行うと1番目のメールより受信を行うよ
		うになります。

メニューのアカウントの「上へ移動」と「下へ移動」は複数のアカウントの並び替えを
行う機能です。アカウントは上に登録されている順に巡回していくので巡回させたい順
番などに並び替えることができます。ただし保存箱と送信箱の移動は行えません。

メニューのアカウントの「新着取得位置の初期化」を選択すると、そのアカウントの次
のチェック時にメール一覧は消えて、サーバ上の1番目のメールから受信するようにな
ります。
新着の取得位置を指定した場合もメール一覧は消えて、指定した番号のメールから受信
を行うようになります。
指定した番号がサーバ上のメール数より大きい場合は最後のメールから受信するように
なります。

■ 受信
メニューより「新着チェック」を選択するとメールの一覧を受信します。
「巡回チェック」は全てのアカウントを巡回して新着メールのチェックを行います。
オプションのチェックで自動チェックを行う設定にしてある場合は指定した間隔で巡回
チェックを行います。

受信用マークは本文をダウンロードしてないメールをダブルクリックすると付加するこ
とができます。
もしくはメニューより「受信用にマーク」を選択することで付加することができます。
受信マークの付いたメールは、メニューより「マークを実行」を選択することで本文を
すべて受信します。

オプションの「新着取得時に受信する行数」は、新着を取得するときに少しだけ本文を
持ってきたい場合に設定します。
0 の場合はヘッダのみしか持ってきません。
本文を完全にダウンロードしてないが、少しだけ本文を持ってきているメールは、一覧
で薄いメールのアイコンが表示されます。

オプションの「新着取得時に本文を全て受信する」にチェックがある場合は新着を取得
するときに本文を全て受信するようになります。これは本文が非常に大きいメールがあ
る場合などメモリを多く消費してしまうので十分に注意してください。
メールを完全に受信すると自動的に削除する設定になっているサーバの場合はこの設定
を行わないようにしてください。

プロバイダなどの設定によってはすべて受信するとサーバから自動的に削除するように
なっている場合があります。その場合はアカウントの設定で、「'RETR' を使わない」
にチェックを入れてください。

オプションで「ヘッダを表示」にチェックがあると、ヘッダを本文の上に表示します。
（ヘッダの文字コードはデコードしていません）
これは本文の一部としているため返信時の引用にも表示されてしまうので編集時に削除
してください。
「ヘッダを表示」にチェックがあり、新着受信時の取得行数が 0 の場合はヘッダのみ
を本文として登録します。
受信マークを付けてshiftキーを押しながら実行すると一時的にヘッダ表示の設定にな
ります。

添付ファイルがあると一覧にクリップのアイコンが表示されます。
クリップのアイコンが付いているメールを開くと「編集」メニューに添付されているファ
イル名が表示されます。
メニューから添付ファイル名を選択すると「開く」か「名前を付けて保存」の確認のダ
イアログが表示されます。
メニューから選択できないようになっている添付ファイル名は完全に受信できていない
ことを示しています。受信マークを付けて「実行」して完全に本文を受信してからもう
一度そのメールを開き直すと選択できるようになります。

新着メールがある場合にメッセージボックスが出ますが、新着があるアカウントが表示
されているときはメッセージボックスは出ません。
メッセージボックスが表示されている間は自動チェックなどで前回の新着マークは消え
ません。
またオプションにより、メッセージボックスを出さないようにしたり、新着がなくても
メッセージボックスを出すようにもできます。
※ 新着がないときのメッセージボックスはアカウントが表示されているときも出ます。
※ 新着がないときのメッセージボックスは自動チェックの時は出ません。

アカウントの設定で、パスワードを省略した場合は、受信処理の度にパスワードを入力
するダイアログが表示されます。パスワード入力画面で「パスワードを一時的に記憶」
にチェックを入れると入力されたパスワードをnPOP終了時まで保持します。
アカウントの設定を開いてOKを押すと一時的に記憶されたパスワードはクリアされます。

■ 巡回チェック
メニューから巡回チェックを選択するか、ツールバーの巡回チェックボタンを押すと、
すべてのアカウントの新着チェックを行います。
※ 複数のアカウントを登録していない場合は必要ない機能です。

アカウント毎の設定により巡回するときにチェックしないアカウントを設定することが
できます。

[オプション]の[チェック]の自動チェックは、指定の分毎に巡回を行う機能です。

新着メールがあるアカウントには本体のコンボボックス内のアカウントの名前の後ろに
 * が付きます。
 * が付いているアカウントを選択したときに * は消えます。

タイトルバーには * が付いてるアカウントの数が表示されます。
	nPOP - [未読アカウント: 3]
この場合 3個のアカウントに新着があり、それをまだ見ていないということになります。
一つもない場合は表示されません。

■ 巡回実行
すべてのアカウントのマークされているアイテムを実行します。
巡回はアカウント内のマークされたメールを実行し、その後そのアカウントの送信マー
クの付いたメールを送信します。
上記の流れを巡回する設定になっている全てのアカウントで行います。

■ 削除
削除には「サーバから削除」と「一覧から削除」の2種類あります。

サーバから削除は、メールに「削除用マーク」を付加して、「マークを実行」すること
で削除できます。サーバからメールが削除されると一覧からも消えます。
（一覧はサーバにあるメールが表示されているため）
保存しておきたい場合は、削除を行う前に保存箱にコピーしてください。

一覧から削除は、サーバ上のメールはそのままで、一覧からのみ削除します。削除して
しまっても新着を先頭から取得しなおすとまた表示することが可能です。

新着チェックで一覧を受信して、読んでしまったら一覧から削除する、そして新着チェッ
クで一覧を受信。。。。という感じで使うとメモリの消費を押さえることができます。
（削除したメールを再度読む場合は新着取得位置を初期化して先頭位置から一覧を取得
してください）

■ 送信
送信する前にアカウントの設定でアカウント毎の送信設定を行ってください。
署名（シグネチャ）はアカウント毎に設定します。

アカウント毎の設定で送信時に自分宛てにコピーを送信することができます。これは自
分のメールアドレスをBCCに加えた動作を常に行うようにします。

送信メールを編集する前に、送信情報を設定する必要があります。
送信情報の「アカウント」は送信で使用するアカウントを選択します。SMTPサーバや署
名は選択したアカウントの情報が使われます。

宛先はメールの送信先です。"," で複数件指定できます。
形式は、
	メールアドレス
	名前 <メールアドレス>
	メールアドレス (名前)
のいずれかで指定してください。
※ これ以外の形式の場合はエラーになる可能性があります

件名はそのメールのタイトルです。

Cc , Bcc ボタンを押すと複数の宛先を設定できます。
Cc で指定したメールアドレスは受け取った人に見えます。
Bcc で指定したメールアドレスは受け取った人には見えません。

添付ファイルを指定する場合は、送信情報の[添付ファイル]のボタンを押して添付ファ
イル一覧の画面にて指定できます。添付ファイル一覧のウィンドウにファイルをドラッ
グ＆ドロップすることで追加を行うことも可能です。
添付するファイルのファイル名に2バイトコードが含まれている場合は受け取った相手
によってはファイル名が見れない場合もあるので注意してください。
オプションの送信の「添付ファイル名はMIME "B" encodingで送信」にチェックを入れ
ると添付するファイルのファイル名をMIME "B" encodingで送信します。
※ チェックを入れていない時は RFC 2231 の形式で送信します。

送信するメールを編集し終わって、「直ちに送信」を選択すると編集していた1件のみ
送信します。

「送信箱に保存」を選択した場合は送信箱に保存されます。その後、送信マークを付け
て、「マークを実行」を選択すると、複数件一度に送信することができます。

送信箱に保存するときにオプションで指定された文字数で自動的に折り返しを行います。
一度送信箱に保存してもう一度再編集を行うと整形されて表示されます。
もし自分で改行を入れていきたい場合は、自動折り返し桁数を 0 に設定してください。
折り返す桁数が 0 の場合は送信箱に保存するときに自動折り返しを行いません。

自動折り返し設定の「引用は折り返さない」は、オプションの作成の引用記号で指定さ
れた文字で始まる行は自動折り返しを行わないということです。

送信設定で「送信箱に保存時に送信箱を表示」にチェックを入れている場合は送信箱に
保存したときにメインウィンドウは送信箱を表示します。
これは「直ちに送信」のときも一時送信箱に保存してから送信しているため同様に送信
箱を表示します。

一覧で未送信のメールはアイコンが無い状態になっています。
送信済みのメールにはメールのアイコンが付きます。
「→」のアイコンは送信用マークです。

送信時にSubjectや本文に1バイトのカナタナがあった場合は2バイトのカタカナに変換
して送信を行います。
機種依存文字(Windows以外では表示できない可能性のある文字)がある場合は編集終了
時に警告が出てその文字が選択状態になります。

返信時の設定は、本体のオプションの「作成」で設定できます。
自動引用にチェックがあると、返信時に指定の引用記号で全文引用されます。
編集時に必要のない引用部分は削除してください。
送信情報で表示される「引用」のチェックボックスでそのメールのみ引用する、しない
の設定を切り替えることができます。

返信用ヘッダは、自動引用するときに引用の頭に付けます。
	%f - From
	%d - Date
	%i - Message-Id
	%s - Subject
	%t - To
	%c - Cc
	%% - %
が使用できます。

もしSMTPサーバが SMTP認証(SMTP Authentication)でユーザの認証を行う環境の場合は
アカウントの設定の送信で「SMTP認証」にチェックを入れてください。
対応している形式は CRAM-MD5 と LOGIN と PLAIN です。

もしSMTPサーバが POP before SMTP (POP3 の認証を利用して、正規ユーザの確認を行
う方法) の環境の場合は、アカウントの設定の送信で「POP before SMTP」にチェック
を入れてください。
SMTPサーバに接続する前にPOP3サーバへ接続しログインのみを行います。

メール表示画面で、メニューより「全員に返信」を選択するとそのメールに設定されて
いる To: と Cc: に設定されている人全員を Cc: に加えて返信を行います。
このときに返信メールの To: に設定されるメールアドレスとそのメールを受け取った
アカウントのメールアドレスは除外されます。

■ フィルタ
アカウント毎の設定に「フィルタ」というのがあります。これは一覧を受信するときに
メールによって特定の動作を行います。例えば「特定のメールは受信しない」や「特定
のメールのみ受信する」といった使い方ができます。
フィルタはメールのヘッダ内の文字列を使って行っています。

フィルタの項目毎の設定は、１つの項目につき２つの条件を組み合わせることができま
す。両方の項目を指定した場合は項目1と項目2の両方を満たす場合という指定になりま
す。

フィルタにはいくつかのルールがあります。
	・全てのメールを「受信する」が標準の動作になっている。
	・「受信する」「受信しない」は先にマッチした方が有効になる。
	・「受信用にマーク」「削除用にマーク」は先にマッチした方が有効になる。
	・「受信する」が先にマッチするとその後の他の動作は無効になる。

動作でフィルタにマッチしたメールの動作を指定します。
項目1,2でどのヘッダ項目を使用するか指定します。
内容1,2でその内容を指定します。
内容は * でワイルドカードを使用することができます。

	例) hoge-ML というMLのメールを受信しない場合
	動作: 受信しない
	項目1: Subject:
	内容1: [hoge-ML*

特定のメールのみを受信する設定にする場合は、フィルタの最後の項目で全てのメール
を受信しないフィルタを追加する必要があります。

	例) hoge-ML というMLのメールのみを受信する場合
	動作: 受信する
	項目1: Subject:
	内容1: [hoge-ML*

	動作: 受信しない
	項目1: Subject:
	内容1: *

受信しない／受信する は先にマッチした方が有効になります。
受信用にマーク／削除用にマーク も同様に先にマッチした方が有効になります。
その他の項目については先にマッチするフィルタがあっても実行されます。
「保存箱へコピー」の動作は受信しないメールについても有効になりコピーされます。

	例）複数の条件を組み合わせる
	動作: 受信しない
	項目1: From:
	内容1: *hoge@hoge.hoge*

	動作: 受信する
	項目1: Subject:
	内容1: [hoge-ML*

	動作: 削除用にマーク
	項目1: Subject:
	内容1: *

上記例は、From: に hoge@hoge.hoge を含むメールは受信しないで、Subject: が
[hoge-ML* のメールは標準の受信動作をして、その他のメールには全て削除用にマーク
を付けるというフィルタになります。

同じアカウント設定を複数作成しフィルタ設定だけを変えて特定のメールだけを受信す
る使い方もできます。

■ アドレス帳
アドレス帳は簡単な機能になっています。個人情報を管理するようなものではなく、
メールアドレスのみを管理できる程度のものです。

設定できる項目は、メールアドレスとコメントのみです。
メールアドレスの形式は、
	メールアドレス
	名前 <メールアドレス>
	メールアドレス (名前)
のいずれかで指定してください。

コメントは256文字以内で自由に設定できます。

アドレス帳にメールアドレスを追加するには直接書き込むのと受信したメールから追加
する方法があります。
受信したメールを開いて、メール表示画面のメニューから「アドレス情報」を選択する
とそのメールが持つメールアドレス一覧が表示され、選択したメールアドレスがアドレ
ス帳に追加されます。

アドレス帳設定画面で、[メール]というボタンを押すと、リストで選択されているメー
ルアドレスにメールを書くことができます。複数選択することも可能です。

アドレス帳は Address.lst というファイル名で保存されています。内容はメールアド
レスとコメントをTAB区切りで1件1行(コメントは省略可)なのでメールアドレスの一覧
などを Address.lst に貼り付けて nPOP を起動すると自動的にアドレス帳に追加され
ます。

■ 検索
受信したメールの本文中やアカウント内の全てのメールから特定の文字列を本文に含む
メールを検索することができます。

メール表示画面の編集メニューの「検索」を選択すると検索の条件を設定できます。
検索文字列には検索したい文字列を入力してください。ワイルドカード(*)などは使え
ません。
大文字と小文字を区別するにチェックを入れると大文字と小文字を区別して検索を行い
ます。
全てのメールから検索にチェックを入れると現在表示されているアカウントの全てのメー
ルが検索対象になります。チェックを入れてない場合は現在表示されているメールの本
文のみから検索します。
件名も検索するにチェックを入れると件名も検索対象になります。検索を行ったときに
検索された文字列が選択状態になっていない場合は件名がマッチした場合です。
本文が取得されていないメールは件名も検索対象にならないので注意してください。

検索文字列が見つかった場合はその文字列が選択状態になります。F3キーを押すかメ
ニューから「次を検索」を選択することで検索条件を変えずに次の文字列を検索します。
（文字列が選択状態にならない場合は件名に検索文字列が見つかったということです）

全てのメールを検索するときは ESCキーで検索をキャンセルできます。

メール一覧の画面から Ctrl+F や F3 を押すと自動的にメールの内容が表示され検索の
動作を行います。

■ コマンドライン
nPOPにコマンドラインを設定して起動できます。
渡せるコマンドラインはメールアドレスかURL(mailto:)です。URL(mailto:)の場合はヘッ
ダに展開されます。

例)
mailto:hoge@hoge.hoge?Subject=test&Body=こんにちは

上記は宛先に hoge@hoge.hoge が設定されて、件名に test が設定されて、本文に「こ
んにちは」が設定されます。

設定可能な項目は、
	To - 宛先
	Cc - Cc
	Bcc - Bcc
	ReplyTo - 返信先
	Subject - 件名
	Body - 本文

	(以下はnPOP固有)
	MailBox - 送信アカウント名
	Attach - 添付ファイル ("～"などのクォート不可)
です。

CcやToを複数項目指定する場合は ,(カンマ) で区切ってください。
添付ファイルを複数指定する場合は | で区切ってください。

例1)
mailto:?Cc=aaa@aaa,bbb@bbb,ccc@ccc
例2)
mailto:?Attach=C:\hoge.txt|C:\My%20Documents\aaa|C:\My Documents\bbb

起動時に表示するアカウントをコマンドラインで指定することも可能です。

nPOP.exe /a:アカウント名

とやることで指定されたアカウントを初期表示します。
既にnPOPが起動済の場合は起動中のnPOPでアカウント表示を切り替えます。
間に空白がある場合は、

nPOP.exe /a:"アカウント 名"

と"～"で括って指定します。
メールアドレスと同時に渡す場合は、 /a: の方を先に指定してください。

nPOP.exe /a:アカウント名 hoge@hoge.hoge
nPOP.exe /a:アカウント名 mailto:hoge@hoge.hoge

■ 外部アプリケーション
外部ビューアはメール表示画面の編集メニューに「外部ビューア」という項目を選択す
ることで起動できます。また一覧でShiftキーを押しながらメールを開くと外部ビューア
で開きます。
外部ビューアは .txt に関連付けられたアプリケーションが起動しますが iniファイル
で起動するアプリケーションを指定することも可能です。

	[GENERAL]
	   ～
	ViewApp=		アプリケーションのパス
	ViewAppClose=0		メール表示から開くときメール表示を閉じる場合は1
	DefViewApp=0		開くで外部アプリケーションを起動するようにする

DefViewApp を 1 にすると一覧でダブルクリックした場合に外部ビューアが起動するよ
うになります。この設定のときにshiftキーを押して開くとnPOPの内部ビューアで表示
します。

編集も上記と同様に外部エディタを使用することができます。
外部エディタは .txt に関連付けられたアプリケーションが起動しますが iniファイル
で起動するアプリケーションを指定することも可能です。

	[GENERAL]
	   ～
	EditApp=		アプリケーションのパス
	DefEditApp=0		開くで外部アプリケーションを起動するようにする

DefEditApp を 1 にすると一覧でダブルクリックした場合に外部エディタが起動するよ
うになります。この設定のときにshiftキーを押して開くとnPOPの内部エディタで表示
します。
外部エディタの終了を監視して本体の内容に反映させているため、外部エディタは複数
起動できる形式のアプリケーションを指定してください。

外部ビューアと外部エディタにコマンドラインを渡すこともできます。

	[GENERAL]
	   ～
	ViewAppCmdLine=		外部ビューアのコマンドライン
	EditAppCmdLine=		外部エディタのコマンドライン

コマンドラインは %1 で渡すファイル名(パスを含む)になります。例えば、
"ファイル名" という感じでファイル名を "～" で括りたい場合は、
	ViewAppCmdLine=""%1""
と指定します。他にコマンドラインを追加したい場合は、
	ViewAppCmdLine="/abc "%1""
と指定します。

コマンドラインを指定しない場合は %1 のみ指定したのと同じ動作をします。

■ その他
メール表示ウィンドウでスペースキーを押すとページダウンをしながら未開封メール
を表示していくことができます。他にAlt+↑↓でメールの移動などもできます。
(一覧画面ではアカウントの移動)

メール表示画面で「右端で折り返す」ようにしていると十字キーの右でスペースキー
の動作(ページダウンをしながら未開封メールを表示)をして、左で Shift + スペース
キーの動作(ページアップ)を行います。

アドレス帳の項目やフィルタ項目を移動する場合にAlt+Uで上、Alt+Dで下に移動するこ
とができます。

保存箱、送信箱、アドレス帳、アカウント毎のファイルの保存先は、EXEファイルと同
じ場所になっていますが、保存先を他の場所に指定したい場合は、iniファイルで設定
できます。
	[GENERAL]
	DataFileDir=
に既存のフォルダのパスを指定します。
指定したフォルダにあらかじめファイルをコピーしておかないと空のファイルを作成し
てしまいます。後で上書きコピーでも構いませんが、プログラムを終了してからコピー
してください。

起動時やウィンドウ表示時にパスワードを要求することができます。
設定はオプションの「その他」の「パスワード設定」で行います。
「起動時にパスワードを要求」にチェックを入れるとnPOPの起動時に設定されているパ
スワードを入力しないと起動できないようになります。
「ウィンドウ表示時にパスワードを要求」にチェックを入れるとウィンドウがアイコン
化していたりタスクトレイに格納されている状態からウィンドウを表示するときに設定
されているパスワードを入力しないと表示できないようになります。
上記の２つの設定のパスワードは一番下にあるパスワードの入力域で設定します。

パスワードを忘れてしまった場合は起動できなくなるので注意してください。

アドレス帳、保存箱、送信箱は変更があるたびにファイルに反映させています。したがっ
てフロッピーで動作させる場合など頻繁にフロッピーにアクセスすることになります。
それを回避するには iniファイルの [GENERAL] の AutoSave を 0 にすると終了時のみ
保存するようになります。
しかしなんらかのトラブルなどでnPOPが強制終了した場合など情報を失う場合があるの
で注意してください。

その他オプション画面で設定できない項目をiniファイルで設定できます。詳細は、
npop_ini.txt を参照してください。

以下は仕様です。
	・LIST は一気に受け取るのではなく一通ずつ取得しています。
	・受信したメールのヘッダのほとんどは捨てています。
	  (References: は最後の一つのみを保存)
	・最後のメールをサーバから削除すると、次回チェック時に削除したメールの
	  前に表示されているメールから受信を行うため、一覧から削除した(サーバ
	  には残っている)メールが再び表示されることがあります。
	・以下の理由によりメールの転送機能はありません。
		・ヘッダのほとんどを捨てている。
		・本文を完全に受信していない場合がある。
		・添付ファイルも一緒に送信するのが大変。
	  返信の件名と本文を修正して転送のように使うことはできます。

■ 更新履歴

・Ver 1.2.4 -> Ver 1.2.5
	・iniファイルでフォントサイズを変更するとダイアログの文字が見えにくく
	　なるのを修正

・Ver 1.2.3 -> Ver 1.2.4
	・起動時のコマンドラインが動作しなかったのを修正
	・メールボックスのファイルが空の場合に空のメッセージができるのを修正

・Ver 1.2.2 -> Ver 1.2.3
	・メールボックス保存時に終端を正しく保存できていなかったのを修正
	  (Special thanks: MSRさん)

・Ver 1.2.1 -> Ver 1.2.2
	・Base64エンコード処理でバッファが溢れる場合があったのを修正
	  (Special thanks: 福田さん)
	・アドレス帳読み込み処理の改善

・Ver 1.2.0 -> Ver 1.2.1
	・SMTP認証の認証方式をアカウント設定から選択できるように変更
	・SMTP設定を開くとポート番号が初期値に戻ってしまうのを修正

・Ver 1.1.0 -> Ver 1.2.0
	・TLS1.1とTLS1.2に対応
	・SSL通信をOpenSSL(npopssl.dll)からWindowsの機能(SChannel)に変更
	・ファイルはすべてUTF-8で出力するように変更(iniファイルのみUTF-16)
	・デフォルトのエンコードをUTF-8に変更
	・高DPIに対応
	・メニューやダイアログの文字を半角カナから全角カナに変更
	・SMTP認証を設定するとポート番号を自動的に「587」になるように変更
	・ダイヤルアップ機能を廃止
	・Windows CE系を廃止
	・UNICODE版のみのリリースに変更

・Ver 1.0.9 -> Ver 1.1.0
	・JIS->SJISの処理で異常終了してしまう場合があったのを修正した。

・Ver 1.0.8 -> Ver 1.0.9
	・一部の文字を含むファイルを添付ファイルとして設定できなかったのを修正
	　した。
	・英文の折り返し処理を修正した。

・Ver 1.0.7 -> Ver 1.0.8
	・Unicode版で起動時のコマンドラインが正常に処理されていないのを修正した。
	・Unicode版でクリッカブルURLが機能しない場合があったのを修正した。
	・受信メール本文のデコードに失敗する場合があったのを修正した。

・Ver 1.0.6 -> Ver 1.0.7
	・httpsとftpのクリッカブルURLが無効になっていたのを修正した。
	・JIS以外のエンコードはOSにインストールされているものを使用するように
	  した。(IE3以上が無い場合はJIS←→SJISのみ)
	・送信時のエンコード方法を設定できるようにした。
	  オプションの送信タブでデフォルトのエンコードを設定し、メール編集画面
	  のメニューからはメール個別のエンコードを設定
	・Unicode版にてUTF-7とUTF-8に対応した。
	・表示フォントをメニューから設定できるようにした。

・Ver 1.0.5 -> Ver 1.0.6
	・受信しないフィルタで強制終了してしまうのを修正した。
	・SMTP-AUTH CRAM-MD5 がエラーになってしまうのを修正した。
	・開くで一時保存した添付ファイルを削除しない設定の時はファイル名に識別
	  子を付けないようにした。
	・iniファイルでUIDLを使う／使わないを設定できるようにした。
	・通信処理を最適化した。

・Ver 1.0.4 -> Ver 1.0.5
	・フィルタ対象のヘッダが長すぎる場合に強制終了してしまうのを修正した。
	・POP3処理を改善してUIDLを優先するよう変更した。
	・メッセージIDが付いていないメールに対する処理を変更した。

・Ver 1.0.3 -> Ver 1.0.4
	・Windows 95, 98, MeでSTARTTLSがエラーになってしまうのを修正した。

・Ver 1.0.2 -> Ver 1.0.3
	・SSLを使用した通信に対応した。(npopssl.dll)
	・アカウントの設定に'RETR'を使わないオプションを追加した。
	  (本文を全て受信するとメールが消えるサーバ対策)
	・POP3のUIDL処理を改善した。
	・メール表示画面から保存マークと削除マークを付ける機能を追加した。
	・添付ファイルを「開く」か「保存」を選択できるようにした。
	・WindowsXPで正しく検索できなかったのを修正した。
	・同時に複数起動した場合に設定が消えてしまう場合があったのを修正した。
	・TOPコマンドをサポートしていないサーバに接続した時に強制終了する場合
	　があったのを修正した。
	・SMTP-AUTH LOGIN の送信方法を変更した。
	・メール表示画面から添付ファイル設定画面を表示できるようにした。
	・メール表示画面にファイルをD&Dして添付ファイルを追加できるようにした。
	　(Win32のみ)

・Ver 1.0.1 -> Ver 1.0.2
	・受信メールの途中にヌル文字('\0')が含まれると受信処理が進まなくなるの
	  を修正した。
	・アドレス帳のリストビューのカラム幅を記憶するようにした。
	・ウィンドウ表示時のパスワード認証が効かない場合があったのを修正した。

・Ver 1.0.0 -> Ver 1.0.1
	・WindowsXP SP1でクリッカブルURLが機能していなかったのを修正した。
	・iniファイルで「送信時に自分宛にコピーを送信」の宛先を設定できるよう
	  にした (アカウント毎のBccAddr)
	・送られてきたメールのタイムゾーンが GMT になっている場合に時間変換が
	  行われないのを修正した。
	・表示パスワードをキャンセルすると強制終了する場合があったのを修正した。
	・不正メモリを参照する可能性がある個所を修正した。

・Ver 0.9.9 -> Ver 1.0.0
	・エンコード、デコード処理を微調整した。

・Ver 0.9.8 -> Ver 0.9.9
	・送信箱の日時形式をiniファイルで設定されたフォーマットに変換するよう
	  にした。
	  ただし新しく作成したメールから有効で過去の送信メールの形式は変わら
	  ない。
	・ISO-2022-KR のエンコード、デコード処理を加えた。

・Ver 0.9.7 -> Ver 0.9.8
	・コマンドライン付きで複数起動した場合は最初の１つのみを処理するよう
	  にした。
	・ウィンドウ表示でパスワードを要求する設定にしているとき、メッセージ
	  の作成でもパスワードを要求するようにした。
	・SMTP認証の認証方式を設定できるようにした (SmtpAuthType)
	・メールボックスが空の場合にゴミメールができてしまうのを修正した。

・Ver 0.9.6 -> Ver 0.9.7
	・フィルタで「受信する」は他の動作を無効になるようにした。
	  これにより開封済みにするなどの動作で特定の条件のメールを除外する事
	  が可能になる。

・Ver 0.9.5 -> Ver 0.9.6
	・メール一覧の保存処理を変更した。
	・iniファイルでタイムアウトの時間を設定できるようにした。

・Ver 0.9.4 -> Ver 0.9.5
	・起動時のコマンドラインで初期表示するアカウントを指定できるようにし
	  た。(/a:)
	・アカウント設定時の自動保存の対象項目を変更した。
	・l'agenda版の2重起動の処理を改善した。
	・メール表示画面のメニューに「添付削除」の項目を追加した。
	・SMTP認証が正常に機能していなかったのを修正した。

・Ver 0.9.3 -> Ver 0.9.4
	・WindowsXPでクリッカブルURLが機能していなかったのを修正した。
	・Win32版でウィンドウをアクティブにする処理を改善した。
	・メールアドレスの抽出処理を改善した。
	・iniファイルに起動時に非表示にするオプションを加えた。
	・iniファイルの AutoSave が 0 の場合は設定後の自動保存を行わないように
	  した。
	・iniファイルの読み込み、保存処理を改善した。

・Ver 0.9.2 -> Ver 0.9.3
	・オプションの送信に「'Date'を送信」を加えた。
	・オプションやアカウントの設定をした後に設定を保存するようにした。
	・Pocket PC版のListViewの動作を改善した。
	・URLを処理するアプリケーションをiniファイルで設定しても有効にならない
	  のを修正した。

・Ver 0.9.1 -> Ver 0.9.2
	・サーバから利用可能なSMTP認証の種類が複数行で返された場合に最後の方式
	  が有効になっていたのをCRAM-MD5、LOGIN、PLAINの順に選択するように修正
	  した。
	・メール表示時に不正メモリを参照する場合があったのを修正した。
	・その他バグフィックス

--

Special thanks:
  Manabu & Naomi Anzai
  Chris De Herrera
  Marlof Bregonje
  Takehiko Hanada
  Antoine
  Greg Chapman
  福田さん
  MSRさん

--

/* Copyright (C) 1991-2, RSA Data Security, Inc. Created 1991. All
rights reserved.

License to copy and use this software is granted provided that it
is identified as the "RSA Data Security, Inc. MD5 Message-Digest
Algorithm" in all material mentioning or referencing this software
or this function.

License is also granted to make and use derivative works provided
that such works are identified as "derived from the RSA Data
Security, Inc. MD5 Message-Digest Algorithm" in all material
mentioning or referencing the derived work.

RSA Data Security, Inc. makes no representations concerning either
the merchantability of this software or the suitability of this
software for any particular purpose. It is provided "as is"
without express or implied warranty of any kind.

These notices must be retained in any copies of any part of this
documentation and/or software.
 */

--

このプログラムによって起きたいかなる障害も作者は責任を持ちません。
大切なファイルはバックアップをとっておくことを強く薦めます。

バグ、要望、質問は nakka@nakka.com までお願いします。

Copyright (C) 1996-2023 by Ohno Tomoaki. All rights reserved.
	https://nakka.com/

2023/6/28
